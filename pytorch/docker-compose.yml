version: "3.9"

services:
  pytorch-cudnn-dev-latest:
    image: pytorch-dev-cudnn8-custom-latest
    runtime: nvidia
    env_file: .devcontainer/devcontainer.env
    build:
      context: .devcontainer
      dockerfile: Dockerfile.pytorch
      shm_size: "8gb"
      args:
        USER: ${USER}
    environment:
      Pytorch_ENV: development
      USER: ${USER}
    container_name: pytorch-devlop-custom-cudnn8-latest
    user: ${USER}
    restart: "always"
    cap_add:
      - ALL
    cap_drop:
      - NET_ADMIN
      - SYS_ADMIN
    ports:
      - "6007:6007"
      - "23:23"
    volumes:
      - /home/liushuai/.config/nvim:/home/liushuai/.config/nvim
      - /home/liushuai/.ssh:/home/liushuai/.ssh
      - /home/liushuai/.tmux.conf:/home/liushuai/.tmux.conf
      - /home/liushuai/.vscode/:/home/liushuai/.vscode
      - /home/liushuai/pytorch:/home/liushuai/pytorch
      - /home/liushuai/pytorch/build:/home/liushuai/pytorch/build
      - /home/liushuai/openlab:/home/liushuai/openlab
    command: /bin/sh -c "while sleep 1000; do :; done"

